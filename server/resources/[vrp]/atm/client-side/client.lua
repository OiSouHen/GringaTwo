-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
local Proxy = module("vrp","lib/Proxy")
vRP = Proxy.getInterface("vRP")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
vSERVER = Tunnel.getInterface("atm")
-----------------------------------------------------------------------------------------------------------------------------------------
-- OPENATM
-----------------------------------------------------------------------------------------------------------------------------------------
AddEventHandler("atm:openSystem",function()
	SetNuiFocus(true,true)
	local saldo = vSERVER.getSaldo()			    
	SendNUIMessage({ action = "show", saldo = tostring(saldo) })
	vRP._playAnim(false,{"amb@prop_human_atm@male@base","base"},true)
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- CLOSEAPP
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("CloseApp", function(data,cb)
	SetNuiFocus(false)
	cb("ok")
	vRP._playAnim(false,{"amb@prop_human_atm@male@exit","exit"},false)
	Citizen.Wait(4000)
	vRP._stopAnim()
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- HANDLESAQUE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("HandleSaque", function(data,cb)
	local valor = parseInt(data.valor)
	local newSaldo = vSERVER.sacarValor(valor)
	cb({ saldo = tostring(newSaldo) })
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- HANDLETRANSFER
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("HandleTransfer", function(data,cb)
	local valor,target = parseInt(data.valor),parseInt(data.target)
	local newSaldo = vSERVER.transferirValor(valor,target)
	cb({ saldo = tostring(newSaldo) })
end)